count(Argumento) %>%
mutate(Argumento = ifelse(n < 7, "Outros", Argumento)) %>%
group_by(Argumento) %>%
summarise(Total = sum(n),
Percentual = Total / denegados_n_decisoes) %>%
mutate(Argumento = factor(Argumento),
Argumento = fct_reorder(Argumento, Percentual))
g_denegados_argumentos <- denegados_argumentos %>%
ggplot(aes(x = argumentos, y = Percentual, fill = argumentos)) +
geom_bar(stat = "identity", width = 0.5) +
scale_fill_manual(values = cores) +
scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,0.6)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 20)) +
labs(x = "", y = "", title = expression(paste(italic("Habeas corpus "), "concedidos: fundamentos"))) +
geom_text(aes(label = scales::percent(Percentual, accuracy = 1L)), hjust = -0.3) +
theme_classic() +
theme(legend.position="none") +
coord_flip()
g_denegados_argumentos
g_denegados_argumentos <- denegados_argumentos %>%
ggplot(aes(x = Argumento, y = Percentual, fill = Argumento)) +
geom_bar(stat = "identity", width = 0.5) +
scale_fill_manual(values = cores) +
scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,0.6)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 20)) +
labs(x = "", y = "", title = expression(paste(italic("Habeas corpus "), "concedidos: fundamentos"))) +
geom_text(aes(label = scales::percent(Percentual, accuracy = 1L)), hjust = -0.3) +
theme_classic() +
theme(legend.position="none") +
coord_flip()
g_denegados_argumentos
denegados_argumentos <- denegados %>%
separate(Argumentos.trazidos.para.denegação.da.ordem, sep = ";", into = c("argumento_1", "argumento_2", "argumento_3", "argumento_4", "argumento_5", "argumento_6"), fill = "right") %>%
select(starts_with("argumento_")) %>%
pivot_longer(cols = starts_with("argumento_"), names_to = "ignora", values_to = "Argumento") %>%
filter(!is.na(Argumento)) %>%
count(Argumento) %>%
mutate(Argumento = ifelse(n < 9, "Outros", Argumento)) %>%
group_by(Argumento) %>%
summarise(Total = sum(n),
Percentual = Total / denegados_n_decisoes) %>%
mutate(Argumento = factor(Argumento),
Argumento = fct_reorder(Argumento, Percentual))
g_denegados_argumentos <- denegados_argumentos %>%
ggplot(aes(x = Argumento, y = Percentual, fill = Argumento)) +
geom_bar(stat = "identity", width = 0.5) +
scale_fill_manual(values = cores) +
scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,0.6)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 20)) +
labs(x = "", y = "", title = expression(paste(italic("Habeas corpus "), "concedidos: fundamentos"))) +
geom_text(aes(label = scales::percent(Percentual, accuracy = 1L)), hjust = -0.3) +
theme_classic() +
theme(legend.position="none") +
coord_flip()
g_denegados_argumentos
denegados_argumentos <- denegados %>%
separate(Argumentos.trazidos.para.denegação.da.ordem, sep = ";", into = c("argumento_1", "argumento_2", "argumento_3", "argumento_4", "argumento_5", "argumento_6"), fill = "right") %>%
select(starts_with("argumento_")) %>%
pivot_longer(cols = starts_with("argumento_"), names_to = "ignora", values_to = "Argumento") %>%
filter(!is.na(Argumento)) %>%
count(Argumento) %>%
mutate(Argumento = ifelse(n < 9, "Outros", Argumento)) %>%
group_by(Argumento) %>%
summarise(Total = sum(n),
Percentual = Total / denegados_n_decisoes) %>%
mutate(Argumento = factor(Argumento),
Argumento = fct_reorder(Argumento, Percentual))
g_denegados_argumentos <- denegados_argumentos %>%
ggplot(aes(x = Argumento, y = Percentual, fill = Argumento)) +
geom_bar(stat = "identity", width = 0.5) +
scale_fill_manual(values = cores) +
scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,0.6)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 20)) +
labs(x = "", y = "", title = expression(paste(italic("Habeas corpus "), "denegados: fundamentos"))) +
geom_text(aes(label = scales::percent(Percentual, accuracy = 1L)), hjust = -0.3) +
theme_classic() +
theme(legend.position="none") +
coord_flip()
g_denegados_argumentos
g_denegados_argumentos <- denegados_argumentos %>%
ggplot(aes(x = Argumento, y = Percentual, fill = Argumento)) +
geom_bar(stat = "identity", width = 0.5) +
scale_fill_manual(values = cores) +
scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,0.8)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 20)) +
labs(x = "", y = "", title = expression(paste(italic("Habeas corpus "), "denegados: fundamentos"))) +
geom_text(aes(label = scales::percent(Percentual, accuracy = 1L)), hjust = -0.3) +
theme_classic() +
theme(legend.position="none") +
coord_flip()
g_denegados_argumentos
g_denegados_argumentos <- denegados_argumentos %>%
ggplot(aes(x = Argumento, y = Percentual, fill = Argumento)) +
geom_bar(stat = "identity", width = 0.5) +
scale_fill_manual(values = cores) +
scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,0.8)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 20)) +
labs(x = "", y = "", title = expression(paste(italic("Habeas corpus "), "denegados: fundamentos"))) +
geom_text(aes(label = scales::percent(Percentual, accuracy = 1L)), hjust = -0.3) +
theme_classic() +
theme(legend.position="none") +
coord_flip()
g_denegados_argumentos
g_denegados_argumentos <- denegados_argumentos %>%
ggplot(aes(x = Argumento, y = Percentual, fill = Argumento)) +
geom_bar(stat = "identity", width = 0.5) +
scale_fill_manual(values = cores) +
scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,1)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 20)) +
labs(x = "", y = "", title = expression(paste(italic("Habeas corpus "), "denegados: fundamentos"))) +
geom_text(aes(label = scales::percent(Percentual, accuracy = 1L)), hjust = -0.3) +
theme_classic() +
theme(legend.position="none") +
coord_flip()
g_denegados_argumentos
g_denegados_argumentos <- denegados_argumentos %>%
ggplot(aes(x = Argumento, y = Percentual, fill = Argumento)) +
geom_bar(stat = "identity", width = 0.5) +
scale_fill_manual(values = cores) +
scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,1)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 20)) +
labs(x = "", y = "", title = expression(paste(italic("Habeas corpus "), "denegados: fundamentos"))) +
geom_text(aes(label = scales::percent(Percentual, accuracy = 1L)), hjust = -0.3) +
theme_classic() +
theme(legend.position="none") +
coord_flip()
g_denegados_argumentos
ggsave("produtos/denegados_fundamentos.png", plot = g_concedidos_argumentos, width = 7, height = 6)
ggsave("produtos/denegados_fundamentos.png", plot = g_denegados_argumentos, width = 7, height = 6)
g_denegados_comorbidades <- denegados_comorbidades %>%
ggplot(aes(x = comorbidade, y = percentual, fill = comorbidade)) +
geom_bar(stat = "identity", width = 0.5) +
scale_fill_manual(values = cores) +
scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,0.8)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 20)) +
labs(x = "", y = "", title = expression(paste(italic("Habeas corpus "), "denegados: comorbidades"))) +
geom_text(aes(label = scales::percent(percentual, accuracy = 1L)), hjust = -0.3) +
theme_classic() +
theme(legend.position="none") +
coord_flip()
g_denegados_comorbidades
g_denegados_comorbidades <- denegados_comorbidades %>%
ggplot(aes(x = comorbidade, y = percentual, fill = comorbidade)) +
geom_bar(stat = "identity", width = 0.5) +
scale_fill_manual(values = cores) +
scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,1)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 20)) +
labs(x = "", y = "", title = expression(paste(italic("Habeas corpus "), "denegados: comorbidades"))) +
geom_text(aes(label = scales::percent(percentual, accuracy = 1L)), hjust = -0.3) +
theme_classic() +
theme(legend.position="none") +
coord_flip()
g_denegados_comorbidades
View(denegados_comorbidades)
denegados_comorbidades <- denegados %>%
filter(!is.na(`Caso.seja.por.comodidade,.qual?`)) %>%
separate(`Caso.seja.por.comodidade,.qual?`, sep = ";", into = c("comorbidade_1", 'comorbidade_2', "comorbidade_3", "comorbidade_4"), fill = "right") %>%
select(starts_with("comorbidade")) %>%
pivot_longer(starts_with("comorbidade"), names_to = "coluna", values_to = "comorbidade") %>%
select(comorbidade) %>%
count(comorbidade) %>%
filter(!is.na(comorbidade)) %>%
mutate(comorbidade = ifelse(n < 4, "Outros", comorbidade)) %>%
group_by(comorbidade) %>%
summarise(n = sum(n)) %>%
ungroup() %>%
mutate(total = denegados_n_decisoes_comorbidade,
percentual = n / total * 100) %>%
group_by(comorbidade) %>%
summarise(Total = sum(n)) %>%
mutate(total_geral = denegados_n_decisoes_comorbidade,
percentual = Total / total_geral)
g_denegados_comorbidades <- denegados_comorbidades %>%
ggplot(aes(x = comorbidade, y = percentual, fill = comorbidade)) +
geom_bar(stat = "identity", width = 0.5) +
scale_fill_manual(values = cores) +
scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,1)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 20)) +
labs(x = "", y = "", title = expression(paste(italic("Habeas corpus "), "denegados: comorbidades"))) +
geom_text(aes(label = scales::percent(percentual, accuracy = 1L)), hjust = -0.3) +
theme_classic() +
theme(legend.position="none") +
coord_flip()
g_denegados_comorbidades
g_denegados_comorbidades <- denegados_comorbidades %>%
ggplot(aes(x = comorbidade, y = percentual, fill = comorbidade)) +
geom_bar(stat = "identity", width = 0.5) +
scale_fill_manual(values = cores) +
scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,0.5)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 20)) +
labs(x = "", y = "", title = expression(paste(italic("Habeas corpus "), "denegados: comorbidades"))) +
geom_text(aes(label = scales::percent(percentual, accuracy = 1L)), hjust = -0.3) +
theme_classic() +
theme(legend.position="none") +
coord_flip()
g_denegados_comorbidades
denegados_comorbidades <- denegados %>%
filter(!is.na(`Caso.seja.por.comodidade,.qual?`)) %>%
separate(`Caso.seja.por.comodidade,.qual?`, sep = ";", into = c("comorbidade_1", 'comorbidade_2', "comorbidade_3", "comorbidade_4"), fill = "right") %>%
select(starts_with("comorbidade")) %>%
pivot_longer(starts_with("comorbidade"), names_to = "coluna", values_to = "comorbidade") %>%
select(comorbidade) %>%
count(comorbidade) %>%
filter(!is.na(comorbidade)) %>%
mutate(comorbidade = ifelse(n < 4, "Outros", comorbidade)) %>%
group_by(comorbidade) %>%
summarise(n = sum(n)) %>%
ungroup() %>%
mutate(total = denegados_n_decisoes_comorbidade,
percentual = n / total * 100) %>%
group_by(comorbidade) %>%
summarise(Total = sum(n)) %>%
mutate(total_geral = denegados_n_decisoes_comorbidade,
percentual = Total / total_geral,
comorbidade = factor(comorbidade),
comorbidade = fct_reorder(percentual))
denegados_comorbidades <- denegados %>%
filter(!is.na(`Caso.seja.por.comodidade,.qual?`)) %>%
separate(`Caso.seja.por.comodidade,.qual?`, sep = ";", into = c("comorbidade_1", 'comorbidade_2', "comorbidade_3", "comorbidade_4"), fill = "right") %>%
select(starts_with("comorbidade")) %>%
pivot_longer(starts_with("comorbidade"), names_to = "coluna", values_to = "comorbidade") %>%
select(comorbidade) %>%
count(comorbidade) %>%
filter(!is.na(comorbidade)) %>%
mutate(comorbidade = ifelse(n < 4, "Outros", comorbidade)) %>%
group_by(comorbidade) %>%
summarise(n = sum(n)) %>%
ungroup() %>%
mutate(total = denegados_n_decisoes_comorbidade,
percentual = n / total * 100) %>%
group_by(comorbidade) %>%
summarise(Total = sum(n)) %>%
mutate(total_geral = denegados_n_decisoes_comorbidade,
percentual = Total / total_geral,
comorbidade = factor(comorbidade),
comorbidade = fct_reorder(comorbidade, percentual))
g_denegados_comorbidades <- denegados_comorbidades %>%
ggplot(aes(x = comorbidade, y = percentual, fill = comorbidade)) +
geom_bar(stat = "identity", width = 0.5) +
scale_fill_manual(values = cores) +
scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,0.5)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 20)) +
labs(x = "", y = "", title = expression(paste(italic("Habeas corpus "), "denegados: comorbidades"))) +
geom_text(aes(label = scales::percent(percentual, accuracy = 1L)), hjust = -0.3) +
theme_classic() +
theme(legend.position="none") +
coord_flip()
g_denegados_comorbidades
ggsave("produtos/denegados_comorbidades.png", plot = g_concedidos_comorbidades, width = 5, height = 4)
ggsave("produtos/denegados_comorbidades.png", plot = g_denegados_comorbidades, width = 5, height = 4)
g_denegados_tipo_prisao <- denegados_tipo_prisao %>%
ggplot(aes(x = Natureza.da.prisão_2, y = Percentual, fill = Natureza.da.prisão_2)) +
geom_bar(stat = "identity", width = 0.5) +
scale_fill_manual(values = cores) +
scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,1)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 20)) +
labs(x = "", y = "", title = expression(paste(italic("Habeas corpus "), "denegados: tipo da prisão"))) +
geom_text(aes(label = scales::percent(Percentual, accuracy = 1L)), vjust = -1) +
theme_classic() +
theme(legend.position="none")
g_concedidos_tipo_prisao
g_denegados_tipo_prisao
ggsave("produtos/denegados_tipo_prisao.png", plot = g_denegados_tipo_prisao, width = 5, height = 4)
View(denegados_comorbidades_comprovacao)
View(concedidos_comprovacao)
View(concedidos_comorbidades_comprovacao)
View(concedidos_comorbidades)
comorbidades <- decisoes %>%
filter(!is.na(`Caso.seja.por.comodidade,.qual?`)) %>%
separate(`Caso.seja.por.comodidade,.qual?`, sep = ";", into = c("comorbidade_1", 'comorbidade_2', "comorbidade_3", "comorbidade_4"), fill = "right") %>%
select(starts_with("comorbidade")) %>%
pivot_longer(starts_with("comorbidade"), names_to = "coluna", values_to = "comorbidade") %>%
select(comorbidade) %>%
count(comorbidade) %>%
filter(!is.na(comorbidade)) %>%
mutate(total = n_decisoes_comorbidade,
percentual = n / total * 100) %>%
mutate(comorbidade = ifelse(n < 4, "Outros", comorbidade)) %>%
group_by(comorbidade) %>%
summarise(Total = sum(n)) %>%
mutate(total_geral = n_decisoes_comorbidade,
percentual = Total / total_geral,
comorbidade = ifelse(comorbidade == "Diabete", "Diabetes", comorbidade),
comorbidade = factor(comorbidade,
levels = c("Cardiopatia", "COVID-19",
"Diabetes", "Doença respiratória",
"Doenças psiquiátricas", "HIV",
"Insuficiência renal", "Tuberculose",
"Outros", "Não informado"),
labels = c("Cardiopatia", "COVID-19",
"Diabetes", "Doença respiratória",
"Doenças psiquiátricas", "HIV",
"Insuficiência renal", "Tuberculose",
"Outros", "Não informado")
),
comorbidade = fct_reorder(comorbidade, percentual)
)
g_comorbidades <- comorbidades %>%
ggplot(aes(x = comorbidade, y = percentual, fill = comorbidade)) +
geom_bar(stat = "identity") +
scale_fill_manual(values = cores) +
scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,0.6)) +
labs(x = "", y = "", title = "Comorbidades alegadas") +
geom_text(aes(label = scales::percent(percentual, accuracy = 1L)), hjust = -0.3) +
coord_flip() +
theme_classic() +
theme(legend.position="none")
g_comorbidades
concedidos_comorbidades <- concedidos %>%
filter(!is.na(`Caso.seja.por.comodidade,.qual?`)) %>%
separate(`Caso.seja.por.comodidade,.qual?`, sep = ";", into = c("comorbidade_1", 'comorbidade_2', "comorbidade_3", "comorbidade_4"), fill = "right") %>%
select(starts_with("comorbidade")) %>%
pivot_longer(starts_with("comorbidade"), names_to = "coluna", values_to = "comorbidade") %>%
select(comorbidade) %>%
count(comorbidade) %>%
filter(!is.na(comorbidade)) %>%
mutate(total = concedidos_n_decisoes_comorbidade,
percentual = n / total * 100) %>%
group_by(comorbidade) %>%
summarise(Total = sum(n)) %>%
mutate(total_geral = concedidos_n_decisoes_comorbidade,
percentual = Total / total_geral,
comorbidade = factor(comorbidade),
comorbidade = fct_reorder(comorbidade, percentual),
comorbidade = ifelse(comorbidade == "Diabete", "Diabetes", comorbidade))
g_concedidos_comorbidades <- concedidos_comorbidades %>%
ggplot(aes(x = comorbidade, y = percentual, fill = comorbidade)) +
geom_bar(stat = "identity", width = 0.5) +
scale_fill_manual(values = cores) +
scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,0.8)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 20)) +
labs(x = "", y = "", title = expression(paste(italic("Habeas corpus "), "concedidos: comorbidades"))) +
geom_text(aes(label = scales::percent(percentual, accuracy = 1L)), hjust = -0.3) +
theme_classic() +
theme(legend.position="none") +
coord_flip()
g_concedidos_comorbidades
concedidos_comorbidades <- concedidos %>%
filter(!is.na(`Caso.seja.por.comodidade,.qual?`)) %>%
separate(`Caso.seja.por.comodidade,.qual?`, sep = ";", into = c("comorbidade_1", 'comorbidade_2', "comorbidade_3", "comorbidade_4"), fill = "right") %>%
select(starts_with("comorbidade")) %>%
pivot_longer(starts_with("comorbidade"), names_to = "coluna", values_to = "comorbidade") %>%
select(comorbidade) %>%
count(comorbidade) %>%
filter(!is.na(comorbidade)) %>%
mutate(total = concedidos_n_decisoes_comorbidade,
percentual = n / total * 100) %>%
group_by(comorbidade) %>%
summarise(Total = sum(n)) %>%
mutate(total_geral = concedidos_n_decisoes_comorbidade,
percentual = Total / total_geral,
comorbidade = factor(comorbidade),
comorbidade = fct_reorder(comorbidade, percentual))
g_concedidos_comorbidades <- concedidos_comorbidades %>%
ggplot(aes(x = comorbidade, y = percentual, fill = comorbidade)) +
geom_bar(stat = "identity", width = 0.5) +
scale_fill_manual(values = cores) +
scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,0.8)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 20)) +
labs(x = "", y = "", title = expression(paste(italic("Habeas corpus "), "concedidos: comorbidades"))) +
geom_text(aes(label = scales::percent(percentual, accuracy = 1L)), hjust = -0.3) +
theme_classic() +
theme(legend.position="none") +
coord_flip()
g_concedidos_comorbidades
concedidos_comorbidades <- concedidos %>%
filter(!is.na(`Caso.seja.por.comodidade,.qual?`)) %>%
separate(`Caso.seja.por.comodidade,.qual?`, sep = ";", into = c("comorbidade_1", 'comorbidade_2', "comorbidade_3", "comorbidade_4"), fill = "right") %>%
select(starts_with("comorbidade")) %>%
pivot_longer(starts_with("comorbidade"), names_to = "coluna", values_to = "comorbidade") %>%
select(comorbidade) %>%
count(comorbidade) %>%
filter(!is.na(comorbidade)) %>%
mutate(total = concedidos_n_decisoes_comorbidade,
percentual = n / total * 100) %>%
group_by(comorbidade) %>%
summarise(Total = sum(n)) %>%
mutate(total_geral = concedidos_n_decisoes_comorbidade,
percentual = Total / total_geral,
comorbidade = ifelse(comorbidade == "Diabete", "Diabetes", comorbidade),
comorbidade = factor(comorbidade),
comorbidade = fct_reorder(comorbidade, percentual))
g_concedidos_comorbidades <- concedidos_comorbidades %>%
ggplot(aes(x = comorbidade, y = percentual, fill = comorbidade)) +
geom_bar(stat = "identity", width = 0.5) +
scale_fill_manual(values = cores) +
scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,0.8)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 20)) +
labs(x = "", y = "", title = expression(paste(italic("Habeas corpus "), "concedidos: comorbidades"))) +
geom_text(aes(label = scales::percent(percentual, accuracy = 1L)), hjust = -0.3) +
theme_classic() +
theme(legend.position="none") +
coord_flip()
g_concedidos_comorbidades
denegados_comorbidades <- denegados %>%
filter(!is.na(`Caso.seja.por.comodidade,.qual?`)) %>%
separate(`Caso.seja.por.comodidade,.qual?`, sep = ";", into = c("comorbidade_1", 'comorbidade_2', "comorbidade_3", "comorbidade_4"), fill = "right") %>%
select(starts_with("comorbidade")) %>%
pivot_longer(starts_with("comorbidade"), names_to = "coluna", values_to = "comorbidade") %>%
select(comorbidade) %>%
count(comorbidade) %>%
filter(!is.na(comorbidade)) %>%
mutate(comorbidade = ifelse(n < 4, "Outros", comorbidade)) %>%
group_by(comorbidade) %>%
summarise(n = sum(n)) %>%
ungroup() %>%
mutate(total = denegados_n_decisoes_comorbidade,
percentual = n / total * 100) %>%
group_by(comorbidade) %>%
summarise(Total = sum(n)) %>%
mutate(total_geral = denegados_n_decisoes_comorbidade,
percentual = Total / total_geral,
comorbidade = ifelse(comorbidade == "Diabete", "Diabetes", comorbidade),
comorbidade = factor(comorbidade),
comorbidade = fct_reorder(comorbidade, percentual))
g_denegados_comorbidades <- denegados_comorbidades %>%
ggplot(aes(x = comorbidade, y = percentual, fill = comorbidade)) +
geom_bar(stat = "identity", width = 0.5) +
scale_fill_manual(values = cores) +
scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,0.5)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 20)) +
labs(x = "", y = "", title = expression(paste(italic("Habeas corpus "), "denegados: comorbidades"))) +
geom_text(aes(label = scales::percent(percentual, accuracy = 1L)), hjust = -0.3) +
theme_classic() +
theme(legend.position="none") +
coord_flip()
g_denegados_comorbidades
source("~/Documents/TCC Bia/scripts/analise_dados.R")
## Create Workbook object and add worksheets
wb_geral <- createWorkbook()
View(camara_criminal)
View(camara_criminal_denegados_ou_concedidos)
View(camara_criminal)
View(camara_criminal_geral)
g_denegados_tipo_prisao <- denegados_tipo_prisao %>%
ggplot(aes(x = Natureza.da.prisão_2, y = Percentual, fill = Natureza.da.prisão_2)) +
geom_bar(stat = "identity", width = 0.5) +
scale_fill_manual(values = cores) +
scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,1)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 20)) +
labs(x = "", y = "", title = expression(paste(italic("Habeas corpus "), "denegados: tipo da prisão"))) +
geom_text(aes(label = scales::percent(Percentual, accuracy = 1L)), vjust = -1) +
theme_classic() +
theme(legend.position="none")
g_denegados_tipo_prisao
g_denegados_tipo_prisao <- denegados_tipo_prisao %>%
ggplot(aes(x = Natureza.da.prisão_2, y = Percentual, fill = Natureza.da.prisão_2)) +
geom_bar(stat = "identity", width = 0.5) +
scale_fill_manual(values = cores) +
scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,1)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 20)) +
labs(x = "", y = "", title = expression(paste(italic("Habeas corpus "), "denegados: natureza da prisão"))) +
geom_text(aes(label = scales::percent(Percentual, accuracy = 1L)), vjust = -1) +
theme_classic() +
theme(legend.position="none")
g_denegados_tipo_prisao
g_concedidos_tipo_prisao <- concedidos_tipo_prisao %>%
ggplot(aes(x = Natureza.da.prisão_2, y = Percentual, fill = Natureza.da.prisão_2)) +
geom_bar(stat = "identity", width = 0.5) +
scale_fill_manual(values = cores) +
scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,1)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 20)) +
labs(x = "", y = "", title = expression(paste(italic("Habeas corpus "), "concedidos: natureza da prisão"))) +
geom_text(aes(label = scales::percent(Percentual, accuracy = 1L)), vjust = -1) +
theme_classic() +
theme(legend.position="none")
g_concedidos_tipo_prisao
g_natureza_prisao <- natureza_prisao %>%
ggplot(aes(x = Natureza.da.prisão_2, y = Percentual, fill = Natureza.da.prisão_2)) +
geom_bar(stat = "identity", width = 0.5) +
scale_fill_manual(values = cores) +
scale_y_continuous(labels = scales::percent_format(accuracy = 5L), limits = c(0,1)) +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
labs(x = "", y = "", title = "Natureza da prisão") +
geom_text(aes(label = scales::percent(Percentual, accuracy = 1L)), vjust = -1) +
theme_classic() +
theme(legend.position="none")
g_natureza_prisao
View(natureza_prisao)
View(denegados_tipo_prisao)
source("~/Documents/TCC Bia/scripts/analise_dados.R")
source("~/Documents/TCC Bia/scripts/analise_dados.R")
library(tidyverse)
library(openxlsx)
library(lubridate)
# Preparar cores
cores <- c("#CBAACB", "#ABDEE6", "#F3B0C3", "#8FCACA", "#FFC8A2", "#FFFFB5",  "#CCE2CB", "#ECD5E3", "#FEE1E8", "#D4F0F0")
# Not in
`%!in%` <- Negate(`%in%`)
# Ler base de dados -------------------------------------------------------
decisoes <- read.xlsx("data/Decisões em habeas corpus - TJMG.xlsx", startRow = 2)
# * Divisao por câmara criminal -------------------------------------------
camara_criminal <- decisoes %>%
count(Câmara.Criminal.julgadora) %>%
mutate(total = sum(n),
prop = n / total)
g_camara_criminal <- camara_criminal %>%
ggplot(aes(x = "", y = prop, fill = Câmara.Criminal.julgadora)) +
geom_bar(stat="identity", width=1, color="white") +
coord_polar("y", start=0) +
theme_void() +
theme(legend.position="none") +
geom_text(aes(label = scales::percent(prop, accuracy = 1L)), position = position_stack(vjust=0.5)) +
labs(x = NULL, y = NULL, fill = NULL) +
theme_classic() +
theme(axis.line = element_blank(),
axis.text = element_blank(),
axis.ticks = element_blank()) +
scale_fill_manual(values=cores) +
labs(title = "Câmara Criminal julgadora")
g_camara_criminal
theme_get()$text
